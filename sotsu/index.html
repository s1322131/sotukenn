<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>VR èƒŒæ™¯ç”»åƒï¼‹å…ˆç”Ÿãƒ¢ãƒ‡ãƒ«é…ç½®</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene vr-mode-ui="enabled: true" lumos-control>

      <!-- â–  èƒŒæ™¯360åº¦ç”»åƒ -->
      <a-sky src="back.png" rotation="0 -90 0"></a-sky>

      <!-- â–  ã‚«ãƒ¡ãƒ©ï¼ˆè¦–ç‚¹ï¼‰ -->
      <a-entity camera look-controls position="0 -3 0"></a-entity>


      <!-- â—‡ å…ˆç”Ÿãƒ¢ãƒ‡ãƒ« -->
      <a-entity id="teacher"
        gltf-model="teacher1.glb"
        position="0 -20 -10"
        rotation="90 70 0"
        scale="14 14 14">
      </a-entity>

      <!-- åˆ¥ãƒ¢ãƒ‡ãƒ«ï¼ˆä¾‹ï¼‰ -->
      <a-entity gltf-model="https://drive.google.com/uc?export=download&id=1OCdmLq3GVszTa0f5S5DMlGM6QOEYYaVk"
          position="0 0 -50">
      </a-entity>


      <!-- ===================================== -->
      <!-- å³æ‰‹ï¼šã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆæ–ï¼‰ -->
      <!-- ===================================== -->
      <a-entity id="rightController"
        oculus-touch-controls="hand: right; model: false"
        vive-controls="hand: right"
        windows-motion-controls="hand: right"
        daydream-controls="hand: right"
        gearvr-controls="hand: right">

        <!-- æ–ãƒ¢ãƒ‡ãƒ« -->
        <a-entity id="wand"
          gltf-model="tsue2.glb"
          scale="0.2 0.2 0.2"
          position="0 0 0"
          rotation="70 0 0">

          <!-- æ–ã®å…ˆã®å…‰ï¼ˆæœ€åˆã¯OFFï¼‰ -->
          <a-entity id="wandLight"
            light="type: point; intensity: 0; distance: 5"
            position="0 0.5 0">
          </a-entity>

        </a-entity>

      </a-entity>


      <!-- å³æ‰‹ãƒãƒ³ãƒ‰ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°å¯¾å¿œ -->
      <a-entity id="rightHandTracking"
        hand-tracking-controls="hand: right">
      </a-entity>


      <!-- å·¦æ‰‹ -->
      <a-entity id="leftHand"
        oculus-touch-controls="hand: left"
        vive-controls="hand: left"
        windows-motion-controls="hand: left"
        daydream-controls="hand: left"
        gearvr-controls="hand: left"
        hand-tracking-controls="hand: left">
      </a-entity>


      <!-- â— ç…§æ˜ -->
      <a-entity light="type: ambient; intensity: 0.8"></a-entity>
      <a-entity light="type: directional; intensity: 0.6" position="1 3 2"></a-entity>

    </a-scene>

    <!-- ===================================== -->
    <!-- ğŸª„ ãƒ«ãƒ¼ãƒ¢ã‚¹åˆ¶å¾¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <!-- ===================================== -->
      <script>
      AFRAME.registerComponent('lumos-control', {
      init: function () {
        const controller = document.querySelector('#rightController');
        const wandTip = document.querySelector('#wandLight'); // æ–ã®å…ˆ
        let isOn = false;
        let currentOrb = null;
  
        controller.addEventListener('triggerdown', () => {
          if (!isOn) {
            // LUMOSï¼ˆã»ã‚ã‚ã‚ã€œã‚“ï¼‰
            isOn = true;
            createMagicOrb();
          } else {
            // NOXï¼ˆæ¶ˆãˆã‚‹ï¼‰
            isOn = false;
            if (currentOrb) {
              currentOrb.setAttribute('animation__fade', {
                property: 'material.opacity',
                to: 0,
                dur: 800,
                easing: "easeOutQuad"
              });
              setTimeout(() => currentOrb.remove(), 850);
            }
          }
        });
  
        function createMagicOrb() {
          currentOrb = document.createElement('a-entity');
  
          // å…‰ã‚‹ç‰
          currentOrb.setAttribute('geometry', 'primitive: sphere; radius: 0.01');
          currentOrb.setAttribute(
            'material',
            'color: #ffffff; emissive: #aaffff; emissiveIntensity: 2; opacity: 0.9'
          );
          currentOrb.setAttribute(
            'light',
            'type: point; intensity: 3; distance: 5'
          );
  
          // æ–å…ˆã®ä½ç½®ã«ã‚¹ãƒãƒ¼ãƒ³
          const pos = new THREE.Vector3();
          wandTip.object3D.getWorldPosition(pos);
          currentOrb.setAttribute('position', `${pos.x} ${pos.y} ${pos.z}`);
  
          // è†¨ã‚‰ã‚€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
          currentOrb.setAttribute('animation__grow', {
            property: 'scale',
            to: '0.6 0.6 0.6',
            dur: 1500,
            easing: "easeOutElastic"
          });
  
          // ã»ã‚“ã®å°‘ã—æºã‚Œã‚‹
          currentOrb.setAttribute('animation__pulse', {
            property: 'scale',
            dir: 'alternate',
            dur: 1500,
            loop: true,
            easing: "easeInOutSine",
            to: '0.7 0.7 0.7'
          });
  
          document.querySelector('a-scene').appendChild(currentOrb);
        }
      }
    });
  </script>




  </body>
</html>




